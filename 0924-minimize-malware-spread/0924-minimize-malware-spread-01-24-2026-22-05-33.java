class Solution {
    int n;
    int par[];
    int size[];
    int INF = Integer.MAX_VALUE / 2;
    public int minMalwareSpread(int[][] graph, int[] initial) {
        n = graph.length;
        par = new int[n];
        size = new int[n];

        for(int i = 0; i < n; i++){
            par[i] = i;
            size[i] = 1;
        }

        for(int i = 0; i < n; i++){
            for(int j = i + 1; j < n; j++){
                if(graph[i][j] == 1) union(i, j);
            }
        }

        Map<Integer, List<Integer>> map = new HashMap<>();
        for(int i = 0; i < n; i++){
            map.putIfAbsent(find(i), new ArrayList<>());
        }

        for(int a : initial){
            map.get(find(a)).add(a);
        }
        int maxSize = 0;
        int ans = INF;
        for(Map.Entry<Integer, List<Integer>> entry : map.entrySet()){
            int key = entry.getKey();
            List<Integer> list = entry.getValue();
            if(list.size() == 1){
                int node = list.get(0);
                if(size[key] > maxSize){
                    ans = node;
                    maxSize = size[key];
                }
                else if(size[key] == maxSize){
                    ans = Math.min(ans, node);
                }
            }
        }
        if(ans == INF) for(int a : initial) ans = Math.min(ans, a);
        return ans;
    }
    int find(int x){
        if(x == par[x]) return x;
        return par[x] = find(par[x]);
    }
    void union(int x, int y){
        int par1 = find(x);
        int par2 = find(y);
        if(par1 != par2){
            par[par1] = par2;
            size[par2] += size[par1];
        }
    }
}